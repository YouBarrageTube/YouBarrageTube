webpackJsonp([1],{"30n6":function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("7+uW"),r={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var i=n("VU/8")({name:"App"},r,!1,function(e){n("dzjc")},null,null).exports,o=n("/ocq"),s={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},e._l(e.currentComments,function(t){return n("p",{key:t.id,class:{pause:!e.isPlaying},style:{top:t.height+"%"}},[e._v(e._s(t.comment))])}))},staticRenderFns:[]};var m=n("VU/8")({name:"Barrage",props:["isPlaying","playerWidth","playerHeight","currentComments"]},s,!1,function(e){n("gATq")},"data-v-4d666846",null).exports,c=n("//Fk"),d=n.n(c),l=function(e,t,n,a,r){var i=this;this.el=e,this.id=t;var o=new d.a(function(e){var t=document.createElement("script");t.src="https://www.youtube.com/iframe_api";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n),window.onYouTubeIframeAPIReady=function(){return e(window.YT)}});r.onPlayerStateChange=function(e,t){console.log(t.data),t.data==YT.PlayerState.BUFFERING&&(e.$emit("onTimeUpdate",Math.floor(e.player.player.getCurrentTime())),e.$emit("onReloadComments")),t.data!==YT.PlayerState.PLAYING&&t.data!==YT.PlayerState.PAUSED||e.$emit("onPlayerStateChange",t.data)},r.onPlayerStateChange=r.onPlayerStateChange.bind(null,r),o.then(function(e){i.player=new e.Player(i.el,{height:n,width:a,videoId:i.id,playerVars:{controls:1,disablekb:0,fs:0,showinfo:0,rel:0},events:{onStateChange:r.onPlayerStateChange}})})},u={name:"Player",props:["isPlaying","videoId","playerWidth","playerHeight"],watch:{videoId:function(e,t){this.player.player.loadVideoById(e)}},mounted:function(){this.player=new l(this.$el,this.videoId,this.playerHeight,this.playerWidth,this);var e=this;console.log(this),setInterval(function(){e.$emit("onTimeUpdate",Math.floor(e.player.player.getCurrentTime()))},1e3)}},h={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{staticStyle:{width:"100%"}})},staticRenderFns:[]};var p=n("VU/8")(u,h,!1,function(e){n("QcXx")},"data-v-3c166fe3",null).exports,v={name:"CommentsArea",props:["comments"],data:function(){return{newComment:"",addedComment:[]}},methods:{onSubmit:function(){this.$emit("onNewComment",this.newComment),this.addedComment.push(this.newComment),console.log(this.addedComment),this.newComment=""}}},f={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[e._l(e.comments,function(t){return n("p",{key:t.id},[e._v(e._s(t.comment))])}),e._v(" "),e._l(e.addedComment,function(t){return n("p",{key:t.id},[e._v(e._s(t))])}),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.newComment,expression:"newComment"}],attrs:{type:"text"},domProps:{value:e.newComment},on:{input:function(t){t.target.composing||(e.newComment=t.target.value)}}}),e._v(" "),n("button",{on:{click:e.onSubmit}},[e._v("Submit")])],2)},staticRenderFns:[]};var y=n("VU/8")(v,f,!1,function(e){n("uJWE")},"data-v-65df4039",null).exports,g=n("mtWM"),C=n.n(g),I={name:"BarragePlayer",data:function(){return{isPlaying:!1,currentTime:0,currentInput:"",submitedInput:"",playerWidth:.7*window.innerWidth,playerHeight:.7*window.innerWidth/16*9,comments:[],currentComments:[],currentIndex:0}},props:["videoId"],components:{barrage:m,player:p,"comments-area":y},methods:{play:function(e){1===e&&(this.isPlaying=!0),2===e&&(this.isPlaying=!1)},addComment:function(e){console.log(e),this.submitedInput=e;var t={videoId:this.videoId,comment:this.submitedInput,videoTime:this.currentTime};console.log(t),C.a.post("/v1/comment",{videoId:this.videoId,comment:this.submitedInput,videoTime:this.currentTime}).then(function(e){console.log(e.data)}).catch(function(e){console.log(e)}),t.height=5*Math.floor(19*Math.random()),this.currentComments.push(t)},updateCurrentComments:function(e){for(var t=this.comments,n=this.currentIndex,a=this.currentComments;n<t.length&&t[n].videoTime<=e;)a.push(t[n]),t[n].height=5*Math.floor(19*Math.random()),n++;this.currentIndex=n,console.log(this.currentComments)},reload:function(){for(this.currentComments=[],this.currentIndex=0;this.currentIndex<this.comments.length&&this.comments[this.currentIndex].videoTime<this.currentTime;)this.currentIndex++;this.updateCurrentComments(this.currentTime)}},mounted:function(){var e=this;C.a.get("/v1/comments",{params:{videoId:this.videoId}}).then(function(t){console.log(t.data),e.comments=t.data,e.updateCurrentComments.call(e,e.currentTime)})},watch:{currentTime:function(e,t){this.updateCurrentComments.call(this,e)},videoId:function(e,t){this.currentComments=[],this.comments=[],this.currentIndex=0;var n=this;C.a.get("/v1/comments",{params:{videoId:e}}).then(function(e){console.log(e.data),n.comments=e.data,n.updateCurrentComments.call(n,n.currentTime)})}}},w={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{width:"100%"}},[n("div",{staticClass:"player-container"},[n("player",{attrs:{isPlaying:e.isPlaying,videoId:e.videoId,playerWidth:e.playerWidth,playerHeight:e.playerHeight},on:{onTimeUpdate:function(t){e.currentTime=t},onPlayerStateChange:e.play,onReloadComments:e.reload}}),e._v(" "),e._l(e.currentComments,function(t){return n("p",{key:t.id,staticClass:"comment",class:{pause:!e.isPlaying},style:{top:t.height+"%"}},[e._v(e._s(t.comment))])})],2),e._v(" "),n("comments-area",{attrs:{comments:e.comments},on:{onNewComment:e.addComment}})],1)},staticRenderFns:[]};var _={components:{"barrage-player":n("VU/8")(I,w,!1,function(e){n("dWKE")},"data-v-96fac6c0",null).exports}},T={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"frame"},[t("barrage-player",{attrs:{videoId:"A0D1h30kXlI"}})],1)},staticRenderFns:[]};var P=n("VU/8")(_,T,!1,function(e){n("30n6")},"data-v-3aa74362",null).exports;a.a.use(o.a);var b=new o.a({routes:[{path:"/",name:"Frame",component:P}]});a.a.config.productionTip=!1,new a.a({el:"#app",router:b,components:{App:i},template:"<App/>"})},QcXx:function(e,t){},dWKE:function(e,t){},dzjc:function(e,t){},gATq:function(e,t){},uJWE:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.ee89dd1a35f7dd4bbb6e.js.map